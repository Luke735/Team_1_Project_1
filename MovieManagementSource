#include <iostream>
#include <fstream>
#include <iomanip>
#include <string>
#include <list>
#include <iterator>
#include <vector>
#include "Movie.h"

using namespace std;

int main() {
    ifstream fin("movie.txt");

    if (!fin.is_open()) {
        cout << "Could not open file" << endl;
    }
    else {
        ofstream fout;
        fout.open("results_1.txt");
        list<Movie> showing, coming;
       // vector<string> names, release_dates, receive_dates, descriptions, statuses;
        string line;
        while (getline(fin, line)) {
            string name = "", release_date = "", receive_date = "", description = "", status_string = "";
            bool status;
            int count = 0, breaker = 0;
            for (count; count < line.size(); count++) {
                char current;
                current = line.at(count);
                if (current == ',') {
                    ++breaker;
                    continue;
                }
                if (breaker == 0) {
                    name.push_back(current);
                }
                if (breaker == 1 && current != ' ') {
                    release_date.push_back(current);
                }
                if (breaker == 2 && current != ' ') {
                    description.push_back(current);
                }
                if (breaker == 3 && current != ' ') {
                    receive_date.push_back(current);
                }
                if (breaker == 4 && current != ' ') {
                    status_string.push_back(current);
                }
            }
            string reldays = "", relmonths = "", relyears = "", recdays = "", recmonths = "", recyears = "";
            int relday, relmonth, relyear, recday, recmonth, recyear;
            reldays.push_back(release_date.at(0));
            reldays.push_back(release_date.at(1));
            relmonths.push_back(release_date.at(3));
            relmonths.push_back(release_date.at(4));
            relyears.push_back(release_date.at(6));
            relyears.push_back(release_date.at(7));
            relyears.push_back(release_date.at(8));
            relyears.push_back(release_date.at(9));
            recdays.push_back(receive_date.at(0));
            recdays.push_back(receive_date.at(1));
            recmonths.push_back(receive_date.at(3));
            recmonths.push_back(receive_date.at(4));
            recyears.push_back(receive_date.at(6));
            recyears.push_back(receive_date.at(7));
            recyears.push_back(receive_date.at(8));
            recyears.push_back(receive_date.at(9));
            relday = stoi(reldays);
            relmonth = stoi(relmonths);
            relyear = stoi(relyears);
            recday = stoi(recdays);
            recmonth = stoi(recmonths);
            recyear = stoi(recyears);
            Date reldate, recdate;
            reldate.set_day(relday);
            reldate.set_month(relmonth);
            reldate.set_year(relyear);
            recdate.set_day(recday);
            recdate.set_month(recmonth);
            recdate.set_year(recyear);
            
            if (status_string == "released") { status = true; }
            if (status_string == "received") { status = false; }
            Movie movie(name, reldate, description, recdate, status);
            if (status == true) { showing.push_back(movie); }
            if (status == false) { coming.push_back(movie); }

        }
        list<Movie>::iterator it;
        for (it = coming.begin(); it != coming.end(); ++it) {
            fout << *it << endl;
        }
        
        /*
        string option = "e";
        //the menu is in a while loop until the option selected is q
        //the menu only reads the first character of the input as the option
        while (option.at(0) != 'q') {
            cout << "MENU" << endl;
            cout << "a - Display movies" << endl;
            cout << "b - Add movies" << endl;
            cout << "c - Edit release dates" << endl;
            cout << "d - Edit movie description" << endl;
            cout << "e - Start showing movies in the theatre" << endl;
            cout << "f - Number of movies before a date" << endl;
            cout << "s - Save" << endl;
            cout << "q - Quit" << endl;
            cout << endl;
            cout << "Choose an option: " << endl;
            cin >> option;

            //explain option here
            if (option.at(0) == 'a') {

            }
            //explain option here
            if (option.at(0) == 'b') {

            }
            //explain option here
            if (option.at(0) == 'c') {

            }
            //explain option here
            if (option.at(0) == 'd') {

            }
            //explain option here
            if (option.at(0) == 'e') {

            }
            //explain option here
            if (option.at(0) == 'f') {

            }
            //explain option here
            if (option.at(0) == 's') {

            }
        }//end while loop

        */
        fin.close();
        fout.close();
    }
    return 0;
}
